<?php
	/**
	*
	* The Processor class is the engine room of all business logic and processing,
	* it is the central processing unit that handles requests and responses in and
	* out of the system making it a Core library of the framework.
	*
	* @version:       1.11.19
	* @package:       FYNIX Framework
	* @author:        Jencube Team
	* @license:       http://opensource.org/licenses/gpl-license.php 
	*                 GNU General Public License (GPL)
	* @copyright:     Copyright (c) 2013 - 2020 Jencube
	* @github:        @deusex0 & @TheOne4All
	* @filesource:    system/libraries/processor.lib
	*
	**/

	class Processor {

		protected $theme_name = 'theme_starter';

		public function __construct() {
			require_once '../mapping/Autoloader.php';		
		}

		protected function loadTable ($table) {
            if (file_exists(DATABASE.strtolower($table).'.dbs')) {
				require_once DATABASE.strtolower($table).'.dbs';
				return new $table;
            }
		}

		private function extendTemplate ($path) {
			if (file_exists(TEMPLATE.strtolower($path).'.tpl')){
				require_once TEMPLATE.strtolower($path).'.tpl';
			}else{
				die ('Master Template Layout does not Exist!');
			}	
		}

		public function render ($page_request_url, $data = []) {
			if(substr($page_request_url, -1) == '/'){ $page_request_url = substr($page_request_url, 0, -1); } //make sure the path does not end with '/'
			if($this->theme_name != ''){ 
				if(substr($this->theme_name, -1) != '/'){ $this->theme_name = $this->theme_name.'/'; }
			}
			$path = strtolower($page_request_url);
			$page_request_url = TEMPLATE.$this->theme_name.strtolower($page_request_url).'.tpl';

			if (file_exists($page_request_url)){
				require_once $page_request_url;
			}else{
				die ('Template Layout does not Exist!');
			}
		}

	}

?>